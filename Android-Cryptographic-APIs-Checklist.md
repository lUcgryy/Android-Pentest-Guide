<div align='center'>

# **Android Cryptographic APIs Checklist**

</div>

## **0. General**

Identifying Insecure and/or Deprecated Cryptographic Algorithms

- [ ] DES, 3DES
- [ ] RC2
- [ ] RC4
- [ ] BLOWFISH
- [ ] MD4
- [ ] MD5
- [ ] SHA1

- Recommend Algorithms
    - Confidentiality algorithms: AES-GCM-256 or ChaCha20-Poly1305
    - Integrity algorithms: SHA-256, SHA-384, SHA-512, BLAKE3, the SHA-3 family
    - Digital signature algorithms: RSA (3072 bits and higher), ECDSA with NIST P-384
    - Key establishment algorithms: RSA (3072 bits and higher), DH (3072 bits or higher), ECDH with NIST P-384

Common Configuration Issues

- [ ] Insufficient Key Length
- [ ] Symmetric Encryption with Hard-Coded Cryptographic Keys
- [ ] Weak Key Generation Functions
- [ ] Weak Random Number Generators
- [ ] Use Custom Implementations of Cryptography
- [ ] Inadequate AES Configuration

    - [ ] Weak Block Cipher Mode: CBC
    - [ ] Predictable Initialization Vector

Padding Oracle Attacks due to Weaker Padding or Block Operation Implementations

- [ ] Find encrypted data in the application
- [ ] A block cipher is used to encrypt the data. The length of the data is a multiple of the common cipher block size like 8 or 16 bytes.
- [ ] The application uses CBC mode to encrypt the data.
- [ ] The application uses PKCS#5 or PKCS#7 padding.
- [ ] The application returns the padding error message to the user. 

## **1. Testing Symmetric Cryptography**


Identify all the instances of the cryptographic primitives in code. Identify all custom cryptography implementations. Look for:

- Classes `Cipher`, `Mac`, `MessageDigest`, `Signature`
- Interfaces `Key`, `PrivateKey`, `PublicKey`, `SecretKey`
- functions `getInstance`, `generateKey`
- exceptions `KeyStoreException`, `CertificateException`, `NoSuchAlgorithmException`
- classes which uses `java.security.*`, `javax.crypto.*`, `android.security.*` and `android.security.keystore.*` packages.

Verify if the used symmetric keys:

- [ ] Are not part of the application resources
- [ ] Cannot be derived from known values
- [ ] Are not hardcoded in code

## **2. Testing the Configuration of Cryptographic Standard Algorithms**

Identify all the instances of the cryptographic primitives in code. Identify all custom cryptography implementations. Look for:

- Classes `Cipher`, `Mac`, `MessageDigest`, `Signature`
- Interfaces `Key`, `PrivateKey`, `PublicKey`, `SecretKey`
- functions `getInstance`, `generateKey`
- exceptions `KeyStoreException`, `CertificateException`, `NoSuchAlgorithmException`
- classes which uses `java.security.*`, `javax.crypto.*`, `android.security.*` and `android.security.keystore.*` packages.

## **3. Testing the Purposes of Keys**

Identify all the instances of the cryptographic primitives in code. Identify all custom cryptography implementations. Look for:

- Classes `Cipher`, `Mac`, `MessageDigest`, `Signature`
- Interfaces `Key`, `PrivateKey`, `PublicKey`, `SecretKey`
- functions `getInstance`, `generateKey`
- exceptions `KeyStoreException`, `CertificateException`, `NoSuchAlgorithmException`
- classes which uses `java.security.*`, `javax.crypto.*`, `android.security.*` and `android.security.keystore.*` packages.

For each identified instance, identify its purpose and its type. It can be used:

- [ ] For encryption/decryption
- [ ] For signing/verifying
- [ ] For maintenance

During verification the following checks should be performed:

- [ ] Are all keys used according to the purpose defined during its creation?
- [ ] For asymmetric keys, is the private key being exclusively used for signing and the public key encryption?
- [ ] Are symmetric keys used for multiple purposes? A new symmetric key should be generated if it's used in a different context.
- [ ] Is cryptography used according to its business purpose?

## **4. Testing Random Number Generation**

Identify all the instances of random number generators and look for either custom or well-known insecure classes: Use `java.security.SecureRandom` instead of `java.Util.Random`.

The seed length should be at least 128 bits.