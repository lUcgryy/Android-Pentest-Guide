<div align='center'>

# **Android Basic Security Checklist**

</div>

## **I. Android Testing Setup**

### **1. Host Device**

- [ ] Android Studio platform tools

### **2. Testing Device**
- Real Device
    - [ ] Device need to be rootable
    - [ ] Enable Developer Mode and USB debugging
- Emulator
    - [ ] [Android X86](https://www.android-x86.org/)
    - [ ] [Genymotion](https://www.genymotion.com/download/)
    - [ ] [AVD](https://developer.android.com/studio/run/managing-avds.html)
    - [] [Corelium](https://www.corellium.com/)

- Rooting mobile device

    - [ ] [Magisk](https://topjohnwu.github.io/Magisk/)
    - [ ] [Rooting Guide](https://www.xda-developers.com/root/)

### **3. Accessing the Device Shell**

- [ ] adb shell
- [ ] adb -s {device serial id} shell (get device serial id using adb devices)

### **4. Host-Device Data Transfer**

- [ ] Send file from host to device: `adb push {host file path} {device file path}`

- [ ] Send file from device to host: `adb pull {device file path} {host file path}`

### **5. Obtaining and Extracting Apps**

Obtaining the app

- [ ] Get the Application directly from the client
- [ ] Download the app from the play store and pull it using ADB

```
gplaycli -p -v -d com.google.android.keep
```
- Alternative App Store
    - [ ] [APKPure](https://apkpure.com/)
    - [ ] [apk-downloader](https://apps.evozi.com/apk-downloader/)
    - [ ] [apkmirror](https://www.apkmirror.com/)
    - [ ] [apk-dl](https://apk-dl.com/)
    - [ ] [androidappsapk](https://androidappsapk.co/)

Extracting the app

- [ ] List all the applications installed on the device: `adb shell pm list packages`
- [ ] Get the file's full path: `adb shell pm path <package name>`
- [ ] Extract the app: `adb pull <file path>`

Installing app

- [ ] `adb install <file path>`

### **6. Information Gathering**
Use apktool to decompile the app: `apktool d <file path>`
Result 
```
$ apktool d UnCrackable-Level3.apk
$ tree
.
├── AndroidManifest.xml
├── apktool.yml
├── lib
├── original
│   ├── AndroidManifest.xml
│   └── META-INF
│       ├── CERT.RSA
│       ├── CERT.SF
│       └── MANIFEST.MF
├── res
...
└── smali

```
Android Manifest: Looking for keywords
- [ ] App permissions: `permission`
- [ ] Backup allowance: android:allowBackup
- [ ] App components: `activity`, `service`, `provider`, `receiver`
- [ ] Debuggable flag: `debuggable`
- Check for application ecosystem
    - [ ] **React Native Application:** com.facebook.com.react entry in the file
    - [ ] **Flutter Application:** 
        - [ ] io.flutter folder from decompiling the app
        - [ ] flutter.embedding entry in the file

Looking for native library: in the lib folder of the apk

Looking for data directory: `objection -g <package name> explore`

Monitoring System logs: `adb logcat > logcat.log`

Tools

- [] [apktool](https://ibotpeaches.github.io/Apktool/)
- [] [objection](https://github.com/sensepost/objection)
- [] [adb](https://developer.android.com/studio/command-line/adb)

### **7. Bypassing the Network Security Configuration**

Adding custom user certificate to the network security configuration

- [ ] Decompile the app using a decompilation tool like apktool: `apktool d <file path>`
- [ ] Make the application trust user certificates by creating a Network Security Configuration that includes `<certificates src="user" />`

    ```xml
    <network-security-config>
        <base-config>
            <trust-anchors>
                <certificates src="system" />
                <certificates src="user" />
            </trust-anchors>
        </base-config>
    </network-security-config>
    ```
- [ ] Rebuild the app: `apktool b <file path>`
- [ ] Repackage the app: `zipalign -v 4 <file path> <file path>` 

Use [Magisk](https://github.com/NVISOsecurity/MagiskTrustUserCerts) to add the proxy's certificate among the system trusted certificates

### **8. Bypassing SSL pinning**

- [ ] [Frida](https://frida.re/docs/android/)
Install Frida client on the host and run Frida server on a Mobile device. Place the Frida server on a mobile device using:

```zsh
> adb push Frida-server /data/local/tmp/
> adb shell
> cd /data/local/tmp/
> chmod +x frida-server
> ./frida-server &
```

Test if Frida server is running properly using :

```zsh
> Frida-ps -Ua
```

- [ ] [Objection](https://github.com/sensepost/objection)

```zsh
> objection -g com.package_name explore
> android sslpinning disable
```